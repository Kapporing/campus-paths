(this.webpackJsonpcampuspaths=this.webpackJsonpcampuspaths||[]).push([[0],{102:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),r=a(11),o=a.n(r),s=a(24),l=a(25),c=a(30),d=a(29),u=(a(56),a(39)),h=a.n(u),p=a(48),g=a(33),m=(a(94),a(68)),f=a(116),v=a(114),E=a(107),P=a(40),b=a(108),k=a(109),w=a(71),y=a(118),C=a(110),S=a(67),M=a.n(S),O=new Map,I=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).canvas=void 0,n.currentClickedPair=void 0,n.entrancesList=void 0,n.selectedMainBuilding=void 0,n.pageReset=void 0,n.drawBigBuildings=function(e){var t=n.props.centralBuilding,a=new Map;t.forEach((function(t,n){var i=t[0];a.set(n,[i.x,i.y]),e.beginPath(),e.lineWidth=15,e.strokeStyle="#4B2E83",e.arc(i.x,i.y,25,0,2*Math.PI),e.stroke()})),O=a},n.drawBuildingPoints=function(e){for(var t=0;t<n.props.buildings.length;t++){var a=n.props.buildings[t];e.beginPath(),e.lineWidth=5,e.strokeStyle="purple",e.arc(a.x,a.y,25,0,2*Math.PI),e.stroke()}},n.drawPath=function(e,t){var a,i=t[0];if(void 0!==i)for(e.beginPath(),n.props.options.hogWild?e.fillStyle="hsl("+Math.floor(361*Math.random())+",100%,50%)":e.fillStyle="yellow",e.arc(i[0],i[1],25,0,2*Math.PI),e.fill(),e.beginPath(),n.props.options.hogWild?e.fillStyle="hsl("+Math.floor(361*Math.random())+",100%,50%)":e.fillStyle="yellow",e.arc(t[t.length-1][0],t[t.length-1][1],25,0,2*Math.PI),e.fill(),a=0;a<t.length-1;a++)e.beginPath(),e.lineWidth=15,e.moveTo(t[a][0],t[a][1]),n.props.options.rainbow?e.strokeStyle="hsl("+a/(t.length-1)*360+",100%,50%)":n.props.options.hogWild?e.strokeStyle="hsl("+Math.floor(361*Math.random())+",100%,50%)":e.strokeStyle="red",e.lineTo(t[a+1][0],t[a+1][1]),e.stroke();n.pageReset?(n.pageReset=!1,n.setState({directionPage:0})):n.pageReset=!0},n.changePage=function(e){var t=n.state.directionPage;t+=e,n.setState({directionPage:t}),n.pageReset=!1},n.calcWaypoints=function(e){for(var t=[],a=1;a<e.length;a++){var n=e[a-1],i=e[a],r=i[0]-n[0],o=i[1]-n[1],s=10;r<50&&o<50&&(s=3);for(var l=0;l<s;l++){var c=n[0]+r*l/s,d=n[1]+o*l/s;t.push([c,d])}}return t},n.animateLine=function(e,t){var a=t[0];e.beginPath(),n.props.options.hogWild?e.fillStyle="hsl("+Math.floor(361*Math.random())+",100%,50%)":e.fillStyle="yellow",e.arc(a[0],a[1],25,0,2*Math.PI),e.fill(),e.arc(t[t.length-1][0],t[t.length-1][1],25,0,2*Math.PI),e.fill();var i=t.slice(0,Math.max(10*(n.state.directionPage+1),0)),r=n.calcWaypoints(i);n.animate(e,1,r),n.pageReset?(n.pageReset=!1,n.setState({directionPage:0})):n.pageReset=!0},n.animate=function(e,t,a){t<a.length-1&&requestAnimationFrame((function(){return n.animate(e,t,a)})),e.beginPath(),n.props.options.rainbow?e.strokeStyle="hsl("+t/(a.length-1)*360+",100%,50%)":n.props.options.hogWild?e.strokeStyle="hsl("+Math.floor(361*Math.random())+",100%,50%)":e.strokeStyle="red",e.moveTo(a[t-1][0],a[t-1][1]),e.lineTo(a[t][0],a[t][1]),e.stroke(),t++},n.handleClick=function(e){var t=n.canvas.current;if(null!==t){var a,i=t.getBoundingClientRect(),r=e.clientX-i.left,o=e.clientY-i.top,s=getComputedStyle(t),l=parseInt(s.getPropertyValue("width"),10),c=t.width/l,d=r*c,u=o*c,h=Object(g.a)(O);try{for(h.s();!(a=h.n()).done;){var m=Object(p.a)(a.value,2),f=m[0],v=m[1];if(Math.abs(v[0]-d)<=40&&Math.abs(v[1]-u)<=40){var E=n.props.centralBuilding.get(f);if(1!==E.length)n.setState({showModal:!0}),n.handleMultipleEntrances(E);else{var P=E[0].shortName;""===n.currentClickedPair[0]?(n.currentClickedPair[0]=P,n.props.sendPath(P,"")):n.currentClickedPair[1]=P}}}}catch(b){h.e(b)}finally{h.f()}""!==n.currentClickedPair[0]&&""!==n.currentClickedPair[1]&&(n.props.sendPath(n.currentClickedPair[0],n.currentClickedPair[1]),n.currentClickedPair=["",""])}},n.handleMultipleEntrances=function(e){n.entrancesList=[],M()(e.length>0),n.setState({entrance:e[0].shortName}),n.selectedMainBuilding=e[0].longName.replace(/\s\(.*\)/,"");for(var t=0;t<e.length;t++){var a=e[t].shortName;n.entrancesList.push(i.a.createElement(m.a,{key:t,value:a,onChange:n.setEntranceOption},a))}},n.setEntranceOption=function(e){n.setState({entrance:e.target.value})},n.setShow=function(e){n.setState({showModal:e})},n.acceptEntrance=function(){n.setShow(!1);var e=n.state.entrance;""===n.currentClickedPair[0]?(n.currentClickedPair[0]=e,n.props.sendPath(e,"")):n.currentClickedPair[1]=e,""!==n.currentClickedPair[0]&&""!==n.currentClickedPair[1]&&(n.props.sendPath(n.currentClickedPair[0],n.currentClickedPair[1]),n.currentClickedPair=["",""])},n.state={backgroundImage:null,directionPage:0,showModal:!1,entrance:""},n.canvas=i.a.createRef(),n.currentClickedPair=["",""],n.entrancesList=[],n.selectedMainBuilding="",n.pageReset=!1,n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.fetchAndSaveImage()}},{key:"componentDidUpdate",value:function(){this.drawBackgroundImage();var e=this.canvas.current;if(null===e)throw Error("Unable to draw, no canvas ref.");var t=e.getContext("2d");if(0!==this.props.points.length){var a=this.props.points;this.props.options.toAnimate?this.animateLine(t,a):this.drawPath(t,a)}this.drawBigBuildings(t)}},{key:"fetchAndSaveImage",value:function(){var e=this,t=new Image;t.onload=function(){e.setState({backgroundImage:t})},t.src="./campus_map.jpg"}},{key:"drawBackgroundImage",value:function(){var e=this.canvas.current;if(null===e)throw Error("Unable to draw, no canvas ref.");var t=e.getContext("2d");if(null===t)throw Error("Unable to draw, no valid graphics context.");null!==this.state.backgroundImage&&(e.width=this.state.backgroundImage.width,e.height=this.state.backgroundImage.height,t.drawImage(this.state.backgroundImage,0,0))}},{key:"render",value:function(){var e=this,t=[],a=[],n=[],r=0;if(0!==this.props.points.length)if(-1===this.props.points[0][0]&&-1===this.props.points[0][1])a.push(i.a.createElement(f.a.Item,{variant:"warning",key:-1},"No Directions Found"));else{var o;for(a.push(i.a.createElement(f.a.Item,{variant:"info",key:0},this.props.directions[0])),o=1;o<this.props.directions.length-1;o++){var s=this.props.directions[o];t.push(i.a.createElement(f.a.Item,{key:o},s)),++r%10===0&&(n.push(t),t=[])}a.push(i.a.createElement(f.a.Item,{variant:"dark",key:o},this.props.directions[o])),t.length>0&&n.push(t)}return i.a.createElement(i.a.Fragment,null,i.a.createElement(v.a,{show:this.state.showModal,onHide:function(){return e.setShow(!1)},centered:!0},i.a.createElement(v.a.Header,{closeButton:!0},i.a.createElement(v.a.Title,null,"Select Entrance")),i.a.createElement(v.a.Body,null,i.a.createElement("div",{className:"text-center"},i.a.createElement("h5",null,this.selectedMainBuilding),i.a.createElement(E.a,{type:"radio",name:"options",className:"button-center"},this.entrancesList))),i.a.createElement(v.a.Footer,null,i.a.createElement(P.a,{variant:"primary",onClick:this.acceptEntrance},"Accept"))),i.a.createElement(b.a,{fluid:!0},i.a.createElement(k.a,null,i.a.createElement(w.a,{xs:12,sm:12,md:12,lg:10,xl:10},i.a.createElement("canvas",{ref:this.canvas,onClick:this.handleClick})),i.a.createElement(w.a,null,i.a.createElement("br",null),i.a.createElement(f.a,null,a),i.a.createElement("br",null),0===n.length?null:i.a.createElement(i.a.Fragment,null,i.a.createElement(y.a,{className:"text-center"},i.a.createElement(y.a.Prev,{onClick:this.state.directionPage>0?function(){return e.changePage(-1)}:function(){e.pageReset=!1,e.setState({directionPage:n.length-1})}}),i.a.createElement(y.a.Next,{onClick:this.state.directionPage<n.length-1?function(){return e.changePage(1)}:function(){return e.setState({directionPage:0})}})),i.a.createElement(C.a,{now:Math.min(10*(this.state.directionPage+1)/r*100,100)})),i.a.createElement(f.a,{variant:"flush"},n[this.state.directionPage])))))}}]),a}(n.Component),B=a(115),L=a(70),x=a(111),R=a(117),F=a(112),j=a(52),N=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).onStartChange=function(e){var t=e.target.options.selectedIndex,a=e.target.options[t].getAttribute("id"),i=e.target.value;n.setState({start:a,startLongname:i})},n.onEndChange=function(e){var t=e.target.options.selectedIndex,a=e.target.options[t].getAttribute("id"),i=e.target.value;n.setState({end:a,endLongname:i})},n.findPath=function(){var e=n.state.start,t=n.state.end;h.a.post("https://pp3ewz3l2f.execute-api.us-west-2.amazonaws.com/prod/path?start=".concat(encodeURIComponent(e),"&end=").concat(encodeURIComponent(t))).then((function(e){n.getPathFinished(e)})).catch((function(e){n.setState({showError:[!0,e.response.data]})}))},n.getPathFinished=function(e){n.sendPath(e.data.path),n.sendDirections(e.data.directions)},n.sendPath=function(e){var t=[];t.push([e.start.x,e.start.y]);var a,i=Object(g.a)(e.path);try{for(i.s();!(a=i.n()).done;){var r=a.value;t.push([r.end.x,r.end.y])}}catch(o){i.e(o)}finally{i.f()}n.props.updatePoints(t)},n.sendDirections=function(e){n.props.updateDirections(e)},n.clearPath=function(){n.setState({start:"",end:"",startLongname:"",endLongname:""}),n.props.updatePoints([])},n.setHogWild=function(){var e=n.state.options;e.hogWild=!e.hogWild,e.rainbow=!1,n.setState({options:e}),n.props.updateOptions(n.state.options)},n.setRainbow=function(){var e=n.state.options;e.rainbow=!e.rainbow,e.hogWild=!1,n.setState({options:e}),n.props.updateOptions(n.state.options)},n.setAnimate=function(){var e=n.state.options;e.toAnimate=!e.toAnimate,n.setState({options:e}),n.props.updateOptions(n.state.options)},n.state={start:"",end:"",startLongname:"",endLongname:"",showError:[!1,""],options:{hogWild:!1,rainbow:!1,toAnimate:!1}},n}return Object(l.a)(a,[{key:"render",value:function(){var e=this,t=[];t.push(i.a.createElement("option",{id:"",key:-1}));var a,n=this.props.buildingsMap,r=Object(g.a)(n);try{for(r.s();!(a=r.n()).done;){var o=Object(p.a)(a.value,2),s=o[0],l=o[1];t.push(i.a.createElement("option",{id:s,key:s},s+" "+l))}}catch(c){r.e(c)}finally{r.f()}return i.a.createElement(i.a.Fragment,null,i.a.createElement(v.a,{show:this.state.showError[0],onHide:function(){return e.setState({showError:[!1,""]})},centered:!0},i.a.createElement(v.a.Header,{closeButton:!0},i.a.createElement(v.a.Title,null,"Error")),i.a.createElement(v.a.Body,null,i.a.createElement("div",{className:"text-center"},i.a.createElement("p",{className:"lead"}," ",this.state.showError[1]," "))),i.a.createElement(v.a.Footer,null,i.a.createElement(P.a,{variant:"primary",onClick:function(){return e.setState({showError:[!1,""]})}},"OK"))),i.a.createElement(b.a,null,i.a.createElement(k.a,null,i.a.createElement(w.a,null,i.a.createElement(B.a.Group,null,i.a.createElement(B.a.Label,null,"Starting Point"),i.a.createElement(B.a.Control,{as:"select",value:this.state.startLongname,onChange:this.onStartChange},t))),i.a.createElement(w.a,null,i.a.createElement(B.a.Group,null,i.a.createElement(B.a.Label,null,"Ending Point"),i.a.createElement(B.a.Control,{as:"select",value:this.state.endLongname,onChange:this.onEndChange},t))),i.a.createElement(w.a,null,i.a.createElement("br",null),i.a.createElement(L.a,null,i.a.createElement(P.a,{variant:"outline-primary",onClick:this.findPath},"Find Path"),i.a.createElement(P.a,{variant:"outline-primary",onClick:this.clearPath},"Clear"),i.a.createElement(x.a,{as:L.a,title:"Options",id:"bg-nested-dropdown",variant:"success"},i.a.createElement(R.a,{placement:"left",delay:{show:250,hide:250},overlay:i.a.createElement(F.a,{id:"hogwild-tooltip"},"Randomize color for path-drawing")},i.a.createElement(j.a.Item,{active:this.state.options.hogWild,onClick:this.setHogWild},"Random Colors")),i.a.createElement(R.a,{placement:"left",delay:{show:250,hide:250},overlay:i.a.createElement(F.a,{id:"rainbow-tooltip"},"Make Path-Color Rainbow")},i.a.createElement(j.a.Item,{active:this.state.options.rainbow,onClick:this.setRainbow},"Rainbow")),i.a.createElement(j.a.Divider,null),i.a.createElement(R.a,{placement:"left",delay:{show:250,hide:250},overlay:i.a.createElement(F.a,{id:"animate-tooltip"},"Animate path-drawing")},i.a.createElement(j.a.Item,{active:this.state.options.toAnimate,onClick:this.setAnimate},"Animate"))))))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){if(""!==e.clickedPaths[0]&&""===e.clickedPaths[1]&&""!==t.start&&""!==t.end){e.updatePoints([]);var a=e.clickedPaths[0];return{start:a,startLongname:""===a?"":a+" "+e.buildingsMap.get(a),end:"",endLongname:""}}if((""!==e.clickedPaths[0]||""!==e.clickedPaths[1])&&(t.start!==e.clickedPaths[0]&&""===t.start||t.end!==e.clickedPaths[1]&&""===t.end)){var n=e.clickedPaths[0],i=""===n?"":n+" "+e.buildingsMap.get(n),r=e.clickedPaths[1];return{start:n,startLongname:i,end:r,endLongname:""===r?"":r+" "+e.buildingsMap.get(r)}}return null}}]),a}(n.Component),W=a(113),A=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).showConnectionFailure=function(){n.setState({connectionFailure:!0})},n.loadBuildings=function(e){var t=new Map,a=[];for(var i in e.data.buildingNames)e.data.buildingNames.hasOwnProperty(i)&&t.set(i,e.data.buildingNames[i]);for(var r=0;r<e.data.buildings.length;r++){var o=e.data.buildings[r];a.push(o)}var s=n.parseBuildings(a);n.setState({buildingsMap:t,buildings:a,centralBuilding:s,buildingsLoaded:!0})},n.parseBuildings=function(e){for(var t=new Map,a=0;a<e.length;a++){var n=e[a],i=n.shortName.substring(0,3);if(t.has(i)){if(void 0!==t.get(i))t.get(i).push(n)}else t.set(n.shortName.substring(0,3),[n])}return t},n.updatePointsList=function(e){n.setState({pointTuples:e}),n.setState({clickedPaths:["",""]})},n.updateDirections=function(e){n.setState({directions:e})},n.updateOptions=function(e){n.setState({drawOptions:e})},n.pointToPoint=function(e,t){n.setState({clickedPaths:[e,t]})},n.state={pointTuples:[],buildingsMap:new Map,directions:[],buildings:[],centralBuilding:new Map,clickedPaths:["",""],connectionFailure:!1,buildingsLoaded:!1,drawOptions:{hogWild:!1,rainbow:!1,toAnimate:!1}},h.a.post("https://pp3ewz3l2f.execute-api.us-west-2.amazonaws.com/prod/buildings").then((function(e){n.loadBuildings(e)})).catch((function(e){alert(e),n.setState({buildingsLoaded:!0})})),n}return Object(l.a)(a,[{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement(v.a,{show:this.state.connectionFailure,onHide:function(){return e.setState({connectionFailure:!1})},centered:!0},i.a.createElement(v.a.Header,{closeButton:!0},i.a.createElement(v.a.Title,null,"Connection Failure")),i.a.createElement(v.a.Body,null,i.a.createElement("div",{className:"text-center"},i.a.createElement("p",null,"There's a problem trying to connect to the server. Try again."))),i.a.createElement(v.a.Footer,null,i.a.createElement(P.a,{variant:"primary",onClick:function(){return e.setState({connectionFailure:!1})}},"OK"))),i.a.createElement("h1",{className:"text-center"},"Campus-Paths"),i.a.createElement(N,{clickedPaths:this.state.clickedPaths,buildingsMap:this.state.buildingsMap,updatePoints:this.updatePointsList,updateDirections:this.updateDirections,updateOptions:this.updateOptions}),this.state.buildingsLoaded?i.a.createElement(I,{sendPath:this.pointToPoint,centralBuilding:this.state.centralBuilding,buildings:this.state.buildings,points:this.state.pointTuples,directions:this.state.directions,options:this.state.drawOptions}):i.a.createElement(W.a,{style:{position:"fixed",top:"50%",left:"50%"},animation:"grow"}))}}]),a}(n.Component);o.a.render(i.a.createElement(A,null),document.getElementById("root"))},72:function(e,t,a){e.exports=a(102)},94:function(e,t,a){}},[[72,1,2]]]);
//# sourceMappingURL=main.dcb965cc.chunk.js.map